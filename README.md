# Технологии виртуализации



## Лабораторная работа №1

* Зайти на [Gitlab кафедры ВС](https://git.csc.sibsutis.ru). Далее будет подразумеваться именно этот **Gitlab**.
* Создать репозиторий. Дальнейшая разработка будет вестись в этом репозитории.
* Сконфигурировать клиент **git** для использования имени и адреса **email** из учетной записи **gitlab**.
* Написать простое приложение, которое запускает **http**-сервер и отдает контент. Контент может быть любым – строка, текст, случайное число и тп. Язык программирования – любой.
* Написать ``Dockerfile`` для данного приложения. Результат сборки – **docker image**, при запуске docker-контейнера из которого, в контейнере запускается разработанное приложение. Файл разместить в репозитории проекта.

## Лабораторная работа №2

* Доработать `Dockerfile` – Для компилируемых языков сделать **multistage** сборку.
    - Этап 1 – компиляция/сборка. Используется образ с наличием компилятора (Например `FROM gcc`)
    - Этап 2 – копирование артефакта компиляции и запуск приложения. Используется образ ОС (Например `FROM alpine`)
    - Проанализировать как изменится размер итогового образа. В случае использования интерпретируемых ЯП, например, **python** – создать в отдельной папке `Dockerfile` и использовать программу **«Hello World»** на компилируемом языке.
* Разработать конфигурацию **Gitlab CI** со следующим функционалом
    - Сборка образа (**Build**, **tag**)
    - Загрузка образа в **Gitlab Registry** (**push**)
    - Удаление образа с **Gitlab Runner**-а  
Допускается опираться на **template ci**, предлагаемый **gitlab**.
* Запуск **CI** должен выполняться автоматически при установке тега для коммита (**git tag**). Так же для любого коммита должна быть возможность запуска «по кнопке» (**manual**). Тегом (**docker tag**) получившегося **docker**-образа является хэш коммита или **git tag**.
* Добавить в проект `.dockerignore` файл, включив в него список файлов, не требуемых для сборки проекта (Синтаксис аналогичен файлу`.gitignore`). Проанализировать как изменится размер итогового образа и время сборки (Для измерения времени и размера можно создать временный большой файл и добавить/убрать его из `.dockerignore`). 
* **Временный файл добавлять в индекс репозитория и коммитить не нужно.**
* **При наличии программы Hello World собирать образ этой программы средствами CI не требуется. Сборка только основного проекта**